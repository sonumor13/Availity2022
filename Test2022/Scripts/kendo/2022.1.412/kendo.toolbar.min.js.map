{"version":3,"file":"kendo.toolbar.min.js","sources":["kendo.toolbar.js"],"sourcesContent":["(function(f, define){\n    define('kendo.toolbar',[ \"./kendo.core\", \"./kendo.userevents\", \"./kendo.popup\", \"./kendo.html.button\" ], f);\n})(function(){\n\nvar __meta__ = { // jshint ignore:line\n    id: \"toolbar\",\n    name: \"ToolBar\",\n    category: \"web\",\n    description: \"The ToolBar widget displays one or more command buttons divided into groups.\",\n    depends: [ \"core\", \"html.button\"  ]\n};\n\n(function($, undefined) {\n    var kendo = window.kendo,\n        Class = kendo.Class,\n        Widget = kendo.ui.Widget,\n        isFunction = kendo.isFunction,\n        keys = kendo.keys,\n        outerWidth = kendo._outerWidth,\n        ns = \".kendoToolBar\",\n\n        TOOLBAR = \"k-toolbar\",\n        KBUTTON = \"k-button\",\n        BUTTON_DEFAULTS = \"k-button-md k-rounded-md k-button-solid k-button-solid-base\",\n        OVERFLOW_BUTTON = \"k-overflow-button\",\n        TOGGLE_BUTTON = \"k-toggle-button\",\n        BUTTON_GROUP = \"k-button-group\",\n        SPLIT_BUTTON = \"k-split-button\",\n        SPLIT_BUTTON_ARROW = \"k-split-button-arrow\",\n        LIST_CONTAINER = \"k-list-container k-split-container\",\n        ICON_BUTTON = \"k-icon-button\",\n        KSEPARATOR = \"k-separator\",\n        SPACER_CLASS = \"k-spacer\",\n        POPUP = \"k-popup\",\n        RESIZABLE_TOOLBAR = \"k-toolbar-resizable\",\n        STATE_ACTIVE = \"k-active\",\n        STATE_DISABLED = \"k-disabled\",\n        STATE_HIDDEN = \"k-state-hidden\",\n        HIDDEN = \"k-hidden\",\n        GROUP_START = \"k-group-start\",\n        GROUP_END = \"k-group-end\",\n        MENU_LINK = \"k-menu-link\",\n        OVERFLOW_GROUP = \"k-overflow-group\",\n        OVERFLOW_HIDDEN = \"k-overflow-hidden\",\n        OVERFLOW_ANCHOR = \"k-overflow-anchor\",\n        OVERFLOW_CONTAINER = \"k-overflow-container\",\n        OVERFLOW_WRAPPER = \"k-overflow-wrapper\",\n        FIRST_TOOLBAR_VISIBLE = \"k-toolbar-first-visible\",\n        LAST_TOOLBAR_VISIBLE = \"k-toolbar-last-visible\",\n        BUTTON_ROUNDED_MD = \"k-rounded-md\",\n\n        MENU_GROUP = \"k-group k-menu-group k-reset k-menu-group-md\",\n\n        ARIA_DISABLED = \"aria-disabled\",\n        ARIA_PRESSED = \"aria-pressed\",\n\n        CLICK = \"click\",\n        TOGGLE = \"toggle\",\n        OPEN = \"open\",\n        CLOSE = \"close\",\n        FOCUS = \"focus\",\n        FOCUSIN = \"focusin\",\n        KEYDOWN = \"keydown\",\n        TAP = \"tap\",\n\n        SPACER = \"spacer\",\n        BOTH = \"both\",\n        PRIMARY = \"primary\",\n        HREF = \"href\",\n        ROLE = \"role\",\n        BUTTON = \"button\",\n        SEPARATOR = \"separator\",\n        OVERFLOW = \"overflow\",\n        NEXT = \"next\",\n        PREV = \"prev\",\n        TABINDEX = \"tabindex\",\n        TEMPLATE = \"template\",\n\n        OVERFLOW_OPEN = \"overflowOpen\",\n        OVERFLOW_CLOSE = \"overflowClose\",\n        OVERFLOW_NEVER = \"never\",\n        OVERFLOW_AUTO = \"auto\",\n        OVERFLOW_ALWAYS = \"always\",\n\n        OPTION_LIST_SUFFIX = \"_optionlist\",\n\n        KENDO_UID_ATTR = kendo.attr(\"uid\"),\n\n        POPUP_ITEM_TEMPLATE = '<li class=\"k-menu-item k-item\">',\n\n        MENU_LINK_SPAN = '<span tabindex=\"0\" class=\"k-link k-menu-link\">' +\n                '<span class=\"k-menu-link-text\">#:text#</span>' +\n            '</span>',\n\n        MENU_LINK_A = '<a href=\"#:href#\" class=\"k-link k-menu-link\">' +\n                '<span class=\"k-menu-link-text\">#:text#</span>' +\n            '</a>',\n\n        EMPTY = \" \",\n        NOTHING = \"\",\n        DOT = \".\",\n        COMMA = \",\",\n        ID = \"id\";\n\n        kendo.toolbar = {};\n\n        var components = {\n            overflowAnchor: '<div tabindex=\"0\" class=\"k-overflow-anchor k-button k-button-md k-rounded-md k-button-flat k-button-flat-base\" title=\"More tools\" role=\"button\"></div>',\n            overflowContainer: '<ul class=\"k-overflow-container k-list-container\"></ul>'\n        };\n\n        kendo.toolbar.registerComponent = function(name, toolbar, overflow) {\n            components[name] = {\n                toolbar: toolbar,\n                overflow: overflow\n            };\n        };\n\n        var Item = kendo.Class.extend({\n            addOverflowAttr: function() {\n                this.element.attr(kendo.attr(OVERFLOW), this.options.overflow || OVERFLOW_AUTO);\n            },\n\n            addUidAttr: function() {\n                this.element.attr(KENDO_UID_ATTR, this.options.uid);\n            },\n\n            addIdAttr: function() {\n                if (this.options.id) {\n                    this.element.attr(ID, this.options.id);\n                }\n            },\n\n            addOverflowIdAttr: function() {\n                if (this.options.id) {\n                    this.element.attr(ID, this.options.id + \"_overflow\");\n                }\n            },\n\n            attributes: function() {\n                var attributes = this.options.attributes,\n                    classes;\n\n                if (attributes) {\n                    if (attributes.class) {\n                        classes = attributes.class;\n\n                        this.element.addClass(classes);\n\n                        delete attributes.class;\n                    }\n\n                    this.element.attr(attributes);\n\n                    attributes.class = classes;\n                }\n            },\n\n            show: function() {\n                this.element.removeClass(STATE_HIDDEN);\n                this.element.removeClass(HIDDEN);\n                this.options.hidden = false;\n            },\n\n            hide: function() {\n                this.element.addClass(STATE_HIDDEN);\n                this.element.addClass(HIDDEN);\n\n                if (this.overflow && this.overflowHidden){\n                    this.overflowHidden();\n                }\n                this.options.hidden = true;\n            },\n\n            remove: function() {\n                this.element.remove();\n            },\n\n            enable: function(isEnabled) {\n                if (isEnabled === undefined) {\n                    isEnabled = true;\n                }\n                this.element.toggleClass(STATE_DISABLED, !isEnabled);\n                this.element.attr(ARIA_DISABLED, !isEnabled);\n\n                this.options.enable = isEnabled;\n            },\n\n            twin: function() {\n                var uid = this.element.attr(KENDO_UID_ATTR);\n                if (this.overflow && this.options.splitContainerId) {\n                    return $(\"#\" + this.options.splitContainerId)\n                            .find(\"[\" + KENDO_UID_ATTR + \"='\" + uid + \"']\")\n                            .data(this.options.type);\n                } else if (this.overflow) {\n                    return this.toolbar\n                            .element\n                            .find(\"[\" + KENDO_UID_ATTR + \"='\" + uid + \"']\")\n                            .data(this.options.type);\n                } else if (this.toolbar.options.resizable) {\n                    return this.toolbar\n                            .popup.element\n                            .find(\"[\" + KENDO_UID_ATTR + \"='\" + uid + \"']\")\n                            .data(this.options.type);\n                }\n            }\n        });\n\n        kendo.toolbar.Item = Item;\n\n        var Button = Item.extend({\n            init: function(options, toolbar) {\n                var element = options.useButtonTag ? $('<button></button>') : $('<a role=\"button\" href></a>');\n\n                this.element = element;\n                this.options = $.extend({}, this.options, options);\n                this.toolbar = toolbar;\n\n                this.attributes();\n\n                if (options.primary) {\n                    this.options.themeColor = PRIMARY;\n                }\n\n                if (options.togglable) {\n                    element.addClass(TOGGLE_BUTTON);\n                    this.toggle(options.selected);\n                }\n\n                if (options.url !== undefined && !options.useButtonTag) {\n                    element.attr(HREF, options.url);\n                    if (options.mobile) {\n                        element.attr(kendo.attr(ROLE), BUTTON);\n                    }\n                }\n\n                if (options.group) {\n                    element.attr(kendo.attr(\"group\"), options.group);\n                    this.group = this.toolbar.addToGroup(this, options.group);\n                }\n\n                if (!options.togglable && options.click && isFunction(options.click)) {\n                    this.clickHandler = options.click;\n                }\n\n                if (options.togglable && options.toggle && isFunction(options.toggle)) {\n                    this.toggleHandler = options.toggle;\n                }\n            },\n\n            options: {\n                showIcon: BOTH,\n                showText: BOTH\n            },\n\n            toggle: function(state, propagate) {\n                state = !!state;\n\n                if (this.group && state) {\n                    this.group.select(this);\n                } else if (!this.group) {\n                    this.select(state);\n                }\n\n                if (propagate && this.twin()) {\n                    this.twin().toggle(state);\n                }\n            },\n\n            getParentGroup: function() {\n                if (this.options.isChild) {\n                    return this.element.closest(DOT + BUTTON_GROUP).data(\"buttonGroup\");\n                }\n            }\n        });\n\n        kendo.toolbar.Button = Button;\n\n        var ToolBarButton = Button.extend({\n            init: function(options, toolbar) {\n                Button.fn.init.call(this, options, toolbar);\n\n                var element = this.element;\n                options = this.options;\n\n                element.addClass(KBUTTON);\n\n                this.addIdAttr();\n\n                if (options.align) {\n                    element.addClass(\"k-align-\" + options.align);\n                }\n\n                if (!!options.text && (options.showText == \"toolbar\" ||  options.showText == BOTH)) {\n                    if (options.mobile) {\n                        element.html('<span class=\"km-text\">' + options.text + \"</span>\");\n                    } else {\n                        element.html(options.text);\n                    }\n                } else if (!!options.text) {\n                    element.attr(\"aria-label\", options.text);\n                }\n\n                if(options.icon || options.spriteCssClass || options.imageUrl) {\n                    if(options.showIcon !== \"toolbar\" && options.showIcon !== BOTH) {\n                        options.icon  = null;\n                        options.spriteCssClass = null;\n                        options.imageUrl = null;\n                    }\n                }\n\n                kendo.html.renderButton(element, options);\n\n                this.addUidAttr();\n                this.addOverflowAttr();\n                this.enable(options.enable);\n\n                if (options.hidden) {\n                    this.hide();\n                }\n\n                this.element.data({\n                    type: BUTTON,\n                    button: this\n                });\n            },\n\n            select: function(selected) {\n                if (selected === undefined) {\n                    selected = false;\n                }\n\n                if (this.options.togglable) {\n                    this.element.attr(ARIA_PRESSED, selected);\n                }\n\n                this.element.toggleClass(STATE_ACTIVE, selected);\n                this.options.selected = selected;\n            }\n        });\n\n        kendo.toolbar.ToolBarButton = ToolBarButton;\n\n        var OverflowButton = Button.extend({\n            init: function(options, toolbar) {\n                this.overflow = true;\n\n                Button.fn.init.call(this, $.extend({}, options), toolbar);\n\n                var element = this.element;\n                options = this.options;\n\n                if (!!options.text && (options.showText == OVERFLOW ||  options.showText == BOTH)) {\n                    if (options.mobile) {\n                        element.html('<span class=\"km-text\">' + options.text + \"</span>\");\n                    } else {\n                        element.html(options.text);\n                    }\n                } else if (!!options.text) {\n                    element.attr(\"aria-label\", options.text);\n                }\n\n                if(options.icon || options.spriteCssClass || options.imageUrl) {\n                    if(options.showIcon !== OVERFLOW && options.showIcon !== BOTH) {\n                        options.icon  = null;\n                        options.spriteCssClass = null;\n                        options.imageUrl = null;\n                    }\n                }\n\n                kendo.html.renderButton(element, options);\n\n                if (!options.isChild) {\n                    this._wrap();\n                }\n\n                this.addOverflowIdAttr();\n                this.attributes();\n                this.addUidAttr();\n                this.addOverflowAttr();\n                this.enable(options.enable);\n\n                element.addClass(OVERFLOW_BUTTON + EMPTY + KBUTTON);\n\n                if (options.hidden) {\n                    this.hide();\n                }\n\n                if (options.togglable){\n                    this.toggle(options.selected);\n                }\n\n                this.element.data({\n                    type: BUTTON,\n                    button: this\n                });\n            },\n\n            _wrap: function() {\n                this.element = this.element.wrap(POPUP_ITEM_TEMPLATE).parent();\n            },\n\n            overflowHidden: function() {\n                this.element.addClass(OVERFLOW_HIDDEN);\n            },\n\n            select: function(selected) {\n                if (selected === undefined) {\n                    selected = false;\n                }\n\n                if (this.options.isChild) {\n                    this.element.toggleClass(STATE_ACTIVE, selected);\n                } else {\n                    this.element.find(DOT + KBUTTON).toggleClass(STATE_ACTIVE, selected);\n                }\n                this.options.selected = selected;\n            }\n        });\n\n        kendo.toolbar.OverflowButton = OverflowButton;\n        kendo.toolbar.registerComponent(BUTTON, ToolBarButton, OverflowButton);\n\n        var ButtonGroup = Item.extend({\n            createButtons: function(buttonConstructor) {\n                var options = this.options;\n                var items = options.buttons || [];\n                var item;\n\n                for (var i = 0; i < items.length; i++) {\n                    if (!items[i].uid) {\n                        items[i].uid = kendo.guid();\n                    }\n                    item = new buttonConstructor($.extend({ mobile: options.mobile, isChild: true, type: BUTTON }, items[i]), this.toolbar);\n                    item.element.appendTo(this.element);\n                }\n            },\n\n            refresh: function() {\n                this.element.children().filter(\":not('.\" + STATE_HIDDEN + \"')\").first().addClass(GROUP_START);\n                this.element.children().filter(\":not('.\" + STATE_HIDDEN + \"')\").last().addClass(GROUP_END);\n            }\n        });\n\n        kendo.toolbar.ButtonGroup = ButtonGroup;\n\n        var ToolBarButtonGroup = ButtonGroup.extend({\n            init: function(options, toolbar) {\n                var element = this.element = $('<div></div>');\n                this.options = options;\n                this.toolbar = toolbar;\n\n                this.addIdAttr();\n\n                if (options.align) {\n                    element.addClass(\"k-align-\" + options.align);\n                }\n\n                this.createButtons(ToolBarButton);\n                this.attributes();\n                this.addUidAttr();\n                this.addOverflowAttr();\n                this.refresh();\n\n                element.addClass(BUTTON_GROUP);\n\n                if (options.hidden) {\n                    this.hide();\n                }\n\n                this.element.data({\n                    type: \"buttonGroup\",\n                    buttonGroup: this\n                });\n            }\n        });\n\n        kendo.toolbar.ToolBarButtonGroup = ToolBarButtonGroup;\n\n        var OverflowButtonGroup = ButtonGroup.extend({\n            init: function(options, toolbar) {\n                var element = this.element = $('<li></li>');\n                this.options = options;\n                this.toolbar = toolbar;\n                this.overflow = true;\n\n                this.addOverflowIdAttr();\n\n                this.createButtons(OverflowButton);\n                this.attributes();\n                this.addUidAttr();\n                this.addOverflowAttr();\n                this.refresh();\n\n                element.addClass((options.mobile ? NOTHING : BUTTON_GROUP) + EMPTY + OVERFLOW_GROUP);\n\n                this.element.data({\n                    type: \"buttonGroup\",\n                    buttonGroup: this\n                });\n            },\n\n            overflowHidden: function() {\n                this.element.addClass(OVERFLOW_HIDDEN);\n            }\n        });\n\n        kendo.toolbar.OverflowButtonGroup = OverflowButtonGroup;\n        kendo.toolbar.registerComponent(\"buttonGroup\", ToolBarButtonGroup, OverflowButtonGroup);\n\n        var ToolBarMenuButton = ToolBarButton.extend({\n            init: function(options, toolbar) {\n                var element, img, span;\n\n                options = this.options = $.extend({}, this.options, options);\n\n                if (options.url !== undefined) {\n                    element = $(kendo.template(MENU_LINK_A)({\n                        href: options.url,\n                        text: options.text\n                    }));\n                } else {\n                    element = $(kendo.template(MENU_LINK_SPAN)({\n                        text: options.text\n                    }));\n                }\n\n                this.element = element;\n                this.toolbar = toolbar;\n\n                if (options.click && isFunction(options.click)) {\n                    this.clickHandler = options.click;\n                }\n\n                if (options.imageUrl) {\n                    img = $('<img alt=\"icon\" class=\"k-image\" />').prependTo(element);\n                    img.attr(\"src\", options.imageUrl);\n                } else if (options.icon) {\n                    span = $('<span></span>').prependTo(element);\n                    span.attr(\"class\", \"k-icon k-i-\" + options.icon);\n                } else if (options.spriteCssClass) {\n                    span = $('<span class=\"k-sprite\"></span>').prependTo(element);\n                    span.addClass(options.spriteCssClass);\n                }\n\n                this.addIdAttr();\n                this.addUidAttr();\n                this.addOverflowAttr();\n                this.attributes();\n                this.enable(options.enable);\n\n                if (options.group) {\n                    element.attr(kendo.attr(\"group\"), options.group);\n                    this.group = this.toolbar.addToGroup(this, options.group);\n                }\n\n                if (options.hidden) {\n                    this.hide();\n                }\n\n                this.element.data({\n                    type: BUTTON,\n                    button: this\n                });\n            }\n        });\n\n        kendo.toolbar.ToolBarMenuButton = ToolBarMenuButton;\n\n        var ToolBarSplitButton = Item.extend({\n            init: function(options, toolbar) {\n                var element = this.element = $('<div class=\"' + SPLIT_BUTTON + EMPTY + BUTTON_GROUP + EMPTY + BUTTON_ROUNDED_MD + '\" tabindex=\"0\"></div>');\n\n                this.options = options;\n                this.toolbar = toolbar;\n\n                this.mainButton = new ToolBarButton($.extend({}, options, { hidden: false }), toolbar);\n                this.arrowButton = $('<a class=\"' + KBUTTON + EMPTY + BUTTON_DEFAULTS + EMPTY + ICON_BUTTON + EMPTY + SPLIT_BUTTON_ARROW + '\"><span class=\"' + (options.mobile ? \"km-icon km-arrowdown\" : \"k-icon k-button-icon k-i-arrow-s\") + '\"></span></a>');\n                this.popupElement = $('<ul class=\"' + LIST_CONTAINER + EMPTY + MENU_GROUP + '\"></ul>');\n\n                this.mainButton.element\n                    .removeAttr(\"href tabindex\")\n                    .appendTo(element);\n\n                this.arrowButton.appendTo(element);\n                this.popupElement.appendTo(element);\n\n                if (options.align) {\n                    element.addClass(\"k-align-\" + options.align);\n                }\n\n                if (!options.id) {\n                    options.id = options.uid;\n                }\n\n                element.attr(ID, options.id + \"_wrapper\");\n\n                this.addOverflowAttr();\n                this.addUidAttr();\n\n                this.createMenuButtons();\n                this.createPopup();\n                this._navigatable();\n\n                this.mainButton.main = true;\n\n                this.enable(options.enable);\n\n                if (options.hidden) {\n                    this.hide();\n                }\n\n                element.data({\n                    type: \"splitButton\",\n                    splitButton: this,\n                    kendoPopup: this.popup\n                });\n            },\n\n            _navigatable: function() {\n                var that = this;\n\n                that.popupElement.on(KEYDOWN + ns, DOT + MENU_LINK, function(e) {\n                    var li = $(e.target).parent();\n\n                    e.preventDefault();\n\n                    if (e.keyCode === keys.ESC || e.keyCode === keys.TAB || (e.altKey && e.keyCode === keys.UP)) {\n                        that.toggle();\n                        that.focus();\n                    } else if (e.keyCode === keys.DOWN) {\n                        findFocusableSibling(li, NEXT).trigger(FOCUS);\n                    } else if (e.keyCode === keys.UP) {\n                        findFocusableSibling(li, PREV).trigger(FOCUS);\n                    } else if (e.keyCode === keys.SPACEBAR || e.keyCode === keys.ENTER) {\n                        that.toolbar.userEvents.trigger(TAP, { target: $(e.target) });\n                    } else if (e.keyCode === keys.HOME) {\n                        li.parent().find(\":kendoFocusable\").first().trigger(FOCUS);\n                    } else if (e.keyCode === keys.END) {\n                        li.parent().find(\":kendoFocusable\").last().trigger(FOCUS);\n                    }\n                });\n            },\n\n            createMenuButtons: function() {\n                var options = this.options;\n                var items = options.menuButtons;\n                var item;\n\n                for (var i = 0; i < items.length; i++) {\n                    item = new ToolBarMenuButton($.extend({ mobile: options.mobile, type: BUTTON, click: options.click }, items[i]), this.toolbar);\n                    item.element.wrap(POPUP_ITEM_TEMPLATE).parent().appendTo(this.popupElement);\n                }\n            },\n\n            createPopup: function() {\n                var that = this;\n                var options = this.options;\n                var element = this.element;\n\n                this.popupElement\n                        .attr(ID, options.id + OPTION_LIST_SUFFIX)\n                        .attr(KENDO_UID_ATTR, options.rootUid);\n\n                if (options.mobile) {\n                    this.popupElement = actionSheetWrap(this.popupElement);\n                }\n\n                this.popup = this.popupElement.kendoPopup({\n                    appendTo: options.mobile ? $(options.mobile).children(\".km-pane\") : null,\n                    anchor: element,\n                    isRtl: this.toolbar._isRtl,\n                    copyAnchorStyles: false,\n                    animation: options.animation,\n                    open: function(e){\n                        var isDefaultPrevented = that.toolbar.trigger(OPEN, { target: element });\n\n                        if(isDefaultPrevented){\n                            e.preventDefault();\n                            return;\n                        }\n\n                        that.adjustPopupWidth(e.sender);\n                    },\n                    activate: function() {\n                        this.element.find(\":kendoFocusable\").first().trigger(FOCUS);\n                    },\n                    close: function(e) {\n                        var isDefaultPrevented = that.toolbar.trigger(CLOSE, { target: element });\n                        if(isDefaultPrevented){\n                            e.preventDefault();\n                        }\n                        element.trigger(FOCUS);\n                    }\n                }).data(\"kendoPopup\");\n\n                this.popup.element.on(CLICK + ns, \"a.k-button\", preventClick);\n            },\n\n            adjustPopupWidth: function (popup) {\n                var anchor = popup.options.anchor,\n                    computedWidth = outerWidth(anchor),\n                    width;\n\n                kendo.wrap(popup.element).addClass(\"k-split-wrapper\");\n\n                if (popup.element.css(\"box-sizing\") !== \"border-box\") {\n                    width = computedWidth - (outerWidth(popup.element) - popup.element.width());\n                } else {\n                    width = computedWidth;\n                }\n\n                popup.element.css({\n                    fontFamily: anchor.css(\"font-family\"),\n                    \"min-width\": width\n                });\n            },\n\n            remove: function() {\n                this.popup.element.off(CLICK + ns, \"a.k-button\");\n                this.popup.destroy();\n                this.element.remove();\n            },\n\n            toggle: function() {\n                if(this.options.enable || this.popup.visible()){\n                    this.popup.toggle();\n                }\n            },\n\n            enable: function(isEnabled) {\n                if (isEnabled === undefined) {\n                    isEnabled = true;\n                }\n\n                this.mainButton.enable(isEnabled);\n                this.element.toggleClass(STATE_DISABLED, !isEnabled);\n                this.element.attr(ARIA_DISABLED, !isEnabled);\n                this.options.enable = isEnabled;\n            },\n\n            focus: function() {\n                this.element.trigger(FOCUS);\n            },\n\n            hide: function() {\n                if (this.popup) {\n                    this.popup.close();\n                }\n\n                this.element.addClass(STATE_HIDDEN);\n                this.element.addClass(HIDDEN);\n                this.options.hidden = true;\n            },\n\n            show: function() {\n                this.element.removeClass(STATE_HIDDEN);\n                this.element.removeClass(HIDDEN);\n                this.options.hidden = false;\n            }\n        });\n\n        kendo.toolbar.ToolBarSplitButton = ToolBarSplitButton;\n\n        var OverflowSplitButton = Item.extend({\n            init: function(options, toolbar) {\n                var element = this.element = $('<li class=\"' + SPLIT_BUTTON + '\"></li>'),\n                    items = options.menuButtons,\n                    item, splitContainerId;\n\n                this.options = options;\n                this.toolbar = toolbar;\n                this.overflow = true;\n                splitContainerId = (options.id || options.uid) + OPTION_LIST_SUFFIX;\n\n                this.mainButton = new OverflowButton($.extend({ isChild: true }, options));\n                this.mainButton.element.appendTo(element);\n\n                for (var i = 0; i < items.length; i++) {\n                    item = new OverflowButton($.extend({ mobile: options.mobile, type: BUTTON, splitContainerId: splitContainerId, isChild: true }, items[i], { click: options.click }), this.toolbar);\n                    item.element.appendTo(element);\n                }\n\n                this.addUidAttr();\n                this.addOverflowAttr();\n\n                this.mainButton.main = true;\n\n                element.data({\n                    type: \"splitButton\",\n                    splitButton: this\n                });\n            },\n\n            overflowHidden: function() {\n                this.element.addClass(OVERFLOW_HIDDEN);\n            }\n        });\n\n        kendo.toolbar.OverflowSplitButton = OverflowSplitButton;\n        kendo.toolbar.registerComponent(\"splitButton\", ToolBarSplitButton, OverflowSplitButton);\n\n        var ToolBarSeparator = Item.extend({\n            init: function(options, toolbar) {\n                var element = this.element = $('<div>&nbsp;</div>');\n\n                this.element = element;\n                this.options = options;\n                this.toolbar = toolbar;\n\n                this.attributes();\n                this.addIdAttr();\n                this.addUidAttr();\n                this.addOverflowAttr();\n\n                element.addClass(KSEPARATOR);\n                element.attr(ROLE, SEPARATOR);\n\n                element.data({\n                    type: SEPARATOR,\n                    separator: this\n                });\n            }\n        });\n\n        var OverflowSeparator = Item.extend({\n            init: function(options, toolbar) {\n                var element = this.element = $('<li>&nbsp;</li>');\n\n                this.element = element;\n                this.options = options;\n                this.toolbar = toolbar;\n                this.overflow = true;\n\n                this.attributes();\n                this.addUidAttr();\n                this.addOverflowIdAttr();\n\n                element.addClass(KSEPARATOR);\n                element.attr(ROLE, SEPARATOR);\n\n                element.data({\n                    type: SEPARATOR,\n                    separator: this\n                });\n            },\n\n            overflowHidden: function() {\n                this.element.addClass(OVERFLOW_HIDDEN);\n            }\n        });\n\n        kendo.toolbar.registerComponent(\"separator\", ToolBarSeparator, OverflowSeparator);\n\n        var ToolBarSpacer = Item.extend({\n            init: function(options, toolbar) {\n                var element = this.element = $('<div>&nbsp;</div>');\n\n                this.element = element;\n                this.options = options;\n                this.toolbar = toolbar;\n\n                element.addClass(SPACER_CLASS);\n\n                element.data({\n                    type: SPACER\n                });\n            }\n        });\n\n        kendo.toolbar.registerComponent(SPACER, ToolBarSpacer);\n\n        var TemplateItem = Item.extend({\n            init: function(template, options, toolbar) {\n                var element = isFunction(template) ? template(options) : template;\n\n                if (!(element instanceof jQuery)) {\n                    element = $(\"<div></div>\").html(element);\n                } else {\n                    element = element.wrap(\"<div></div>\").parent();\n                }\n\n                this.element = element;\n                this.options = options;\n                this.options.type = TEMPLATE;\n                this.toolbar = toolbar;\n\n                this.attributes();\n                this.addUidAttr();\n                this.addIdAttr();\n                this.addOverflowAttr();\n\n                if (options.hidden) {\n                    this.hide();\n                }\n\n                element.data({\n                    type: TEMPLATE,\n                    template: this\n                });\n            }\n        });\n\n        kendo.toolbar.TemplateItem = TemplateItem;\n\n        var OverflowTemplateItem = Item.extend({\n            init: function(template, options, toolbar) {\n                var element = isFunction(template) ? $(template(options)) : $(template);\n\n                if (!(element instanceof jQuery)) {\n                    element = $(\"<li></li>\").html(element);\n                } else {\n                    element = element.wrap(\"<li></li>\").parent();\n                }\n\n                this.element = element;\n                this.options = options;\n                this.options.type = TEMPLATE;\n                this.toolbar = toolbar;\n                this.overflow = true;\n\n                this.attributes();\n                this.addUidAttr();\n                this.addOverflowIdAttr();\n                this.addOverflowAttr();\n\n                element.data({\n                    type: TEMPLATE,\n                    template: this\n                });\n            },\n\n            overflowHidden: function() {\n                this.element.addClass(OVERFLOW_HIDDEN);\n            }\n        });\n\n        kendo.toolbar.OverflowTemplateItem = OverflowTemplateItem;\n\n        function toggleActive(e) {\n            if (!e.target.is(\".k-toggle-button\")) {\n                e.target.toggleClass(STATE_ACTIVE, e.type == \"press\");\n            }\n        }\n\n        function actionSheetWrap(element) {\n            element = $(element);\n\n            return element.hasClass(\"km-actionsheet\") ? element.closest(\".km-popup-wrapper\") : element.addClass(\"km-widget km-actionsheet\")\n                             .wrap('<div class=\"km-actionsheet-wrapper km-actionsheet-tablet km-widget km-popup\"></div>').parent()\n                             .wrap('<div class=\"km-popup-wrapper k-popup\"></div>').parent();\n        }\n\n        function preventClick(e) {\n            if ($(e.target).closest(\"a.k-button\").length) {\n                e.preventDefault();\n            }\n        }\n\n        function findFocusableSibling (element, dir) {\n            var getSibling = dir === NEXT ? $.fn.next : $.fn.prev;\n            var getter = dir === NEXT ? $.fn.first : $.fn.last;\n            var candidate = getSibling.call(element);\n\n            if(!candidate.length && element.is(DOT + OVERFLOW_ANCHOR)){\n                return element;\n            }\n\n            if (candidate.is(\":kendoFocusable\") || !candidate.length) {\n                return candidate;\n            }\n\n            if (candidate.find(\":kendoFocusable\").length) {\n                return getter.call(candidate.find(\":kendoFocusable\"));\n            }\n\n            return findFocusableSibling(candidate, dir);\n        }\n\n        var Group = Class.extend({\n            init: function(name) {\n                this.name = name;\n                this.buttons = [];\n            },\n\n            add: function(button) {\n                this.buttons[this.buttons.length] = button;\n            },\n\n            remove: function(button) {\n                var index = $.inArray(button, this.buttons);\n                this.buttons.splice(index, 1);\n            },\n\n            select: function(button) {\n                var tmp;\n                for (var i = 0; i < this.buttons.length; i ++) {\n                    tmp = this.buttons[i];\n\n                    tmp.select(false);\n                }\n\n                button.select(true);\n                if (button.twin()) {\n                    button.twin().select(true);\n                }\n            }\n        });\n\n        var ToolBar = Widget.extend({\n            init: function(element, options) {\n                var that = this;\n                Widget.fn.init.call(that, element, options);\n\n                options = that.options;\n                element = that.wrapper = that.element;\n\n                element.addClass(TOOLBAR + \" k-widget\");\n                element.attr(ROLE, \"toolbar\");\n\n                this.uid = kendo.guid();\n                this._isRtl = kendo.support.isRtl(element);\n                this._groups = {};\n                element.attr(KENDO_UID_ATTR, this.uid);\n\n                that.isMobile = (typeof options.mobile === \"boolean\") ? options.mobile : that.element.closest(\".km-root\")[0];\n                that.animation = that.isMobile ? { open: { effects: \"fade\" } } : {};\n\n                if (that.isMobile) {\n                    element.addClass(\"km-widget\");\n                    KBUTTON = \"km-button\";\n                    BUTTON_GROUP = \"km-buttongroup\";\n                    STATE_ACTIVE = \"km-state-active\";\n                    STATE_DISABLED = \"km-state-disabled\";\n                }\n\n                if(options.resizable) {\n                    that._renderOverflow();\n                    element.addClass(RESIZABLE_TOOLBAR);\n\n                    that.overflowUserEvents = new kendo.UserEvents(that.element, {\n                        threshold: 5,\n                        allowSelection: true,\n                        filter: DOT + OVERFLOW_ANCHOR,\n                        tap: that._toggleOverflow.bind(that)\n                    });\n\n                    that._resizeHandler = kendo.onResize(function() {\n                        that.resize();\n                    });\n                } else {\n                    that.popup = { element: $([]) };\n                }\n\n                if(options.items && options.items.length) {\n                    for (var i = 0; i < options.items.length; i++) {\n                        that.add(options.items[i]);\n                    }\n\n                    if(options.resizable) {\n                        that._shrink(that.element.innerWidth());\n                    }\n                }\n\n                that.userEvents = new kendo.UserEvents(document.documentElement, {\n                    threshold: 5,\n                    allowSelection: true,\n                    filter:\n                        \"[\" + KENDO_UID_ATTR + \"=\" + this.uid + \"] a.\" + KBUTTON + COMMA + EMPTY +\n                        \"[\" + KENDO_UID_ATTR + \"=\" + this.uid + \"] .\" + MENU_LINK + COMMA + EMPTY +\n                        \"[\" + KENDO_UID_ATTR + \"=\" + this.uid + \"] .\" + OVERFLOW_BUTTON,\n                    tap: that._buttonClick.bind(that),\n                    press: toggleActive,\n                    release: toggleActive\n                });\n\n                that.element.on(CLICK + ns, \"a.k-button\", preventClick);\n                that._navigatable();\n\n                if (options.resizable) {\n                    that.popup.element.on(CLICK + ns, + \"a.k-button\", preventClick);\n                }\n\n                if (options.resizable) {\n                    this._toggleOverflowAnchor();\n                }\n\n                kendo.notify(that);\n            },\n\n            events: [\n                CLICK,\n                TOGGLE,\n                OPEN,\n                CLOSE,\n                OVERFLOW_OPEN,\n                OVERFLOW_CLOSE\n            ],\n\n            options: {\n                name: \"ToolBar\",\n                items: [],\n                resizable: true,\n                mobile: null\n            },\n\n            addToGroup: function(button, groupName) {\n                var group;\n\n                if (!this._groups[groupName]) {\n                    group = this._groups[groupName] = new Group();\n                } else {\n                    group = this._groups[groupName];\n                }\n\n                group.add(button);\n                return group;\n            },\n\n            destroy: function() {\n                var that = this;\n\n                that.element.find(DOT + SPLIT_BUTTON).each(function(idx, element) {\n                    $(element).data(\"kendoPopup\").destroy();\n                });\n\n                that.element.off(ns, \"a.k-button\");\n\n                that.userEvents.destroy();\n\n                if (that.options.resizable) {\n                    kendo.unbindResize(that._resizeHandler);\n                    that.overflowUserEvents.destroy();\n                    that.popup.element.off(ns, \"a.k-button\");\n                    that.popup.destroy();\n                }\n\n                Widget.fn.destroy.call(that);\n            },\n\n            add: function(options) {\n                var component = components[options.type],\n                    template = options.template,\n                    tool, that = this,\n                    itemClasses = that.isMobile ? NOTHING : \"k-item\",\n                    overflowTemplate = options.overflowTemplate,\n                    overflowTool;\n\n                $.extend(options, {\n                    uid: kendo.guid(),\n                    animation: that.animation,\n                    mobile: that.isMobile,\n                    rootUid: that.uid\n                });\n\n                if (options.menuButtons) {\n                    for (var i = 0; i < options.menuButtons.length; i++) {\n                        $.extend(options.menuButtons[i], {\n                            uid: kendo.guid()\n                        });\n                    }\n                }\n\n                if ((template && !overflowTemplate) || options.type === SPACER) {\n                    options.overflow = OVERFLOW_NEVER;\n                } else if (!options.overflow) {\n                    options.overflow = OVERFLOW_AUTO;\n                }\n\n                //add the command in the overflow popup\n                if (options.overflow !== OVERFLOW_NEVER && that.options.resizable) {\n                    if (overflowTemplate) { //template command\n                         overflowTool = new OverflowTemplateItem(overflowTemplate, options, that);\n                    } else if (component) { //build-in command\n                        overflowTool = new component.overflow(options, that);\n                        overflowTool.element.addClass(itemClasses);\n                    }\n\n                    if (overflowTool) {\n                        if (options.overflow === OVERFLOW_AUTO) {\n                            overflowTool.overflowHidden();\n                        }\n\n                        overflowTool.element.appendTo(that.popup.container);\n                        that.angular(\"compile\", function(){\n                            return { elements: overflowTool.element.get() };\n                        });\n                    }\n                }\n\n                //add the command in the toolbar container\n                if (options.overflow !== OVERFLOW_ALWAYS) {\n                    if (template) { //template command\n                        tool = new TemplateItem(template, options, that);\n                    } else if (component) { //build-in command\n                        tool = new component.toolbar(options, that);\n                    }\n\n                    if (tool) {\n                        tool.element.appendTo(that.element);\n\n                        that.angular(\"compile\", function(){\n                            return { elements: tool.element.get() };\n                        });\n                    }\n                }\n            },\n\n            _getItem: function(candidate) {\n                var element,\n                    toolbarItem,\n                    overflowItem,\n                    isResizable = this.options.resizable,\n                    type;\n\n                //find toolbar item\n\n                element = this.element.find(candidate);\n                if (!element.length) {\n                    element = $(\".k-split-container[data-uid=\" + this.uid + \"]\").find(candidate);\n                }\n\n                type = element.length ? element.data(\"type\") : NOTHING;\n                toolbarItem = element.data(type);\n\n                if (toolbarItem) {\n                    if (toolbarItem.main) {\n                        element = element.parent(DOT + SPLIT_BUTTON);\n                        type = \"splitButton\";\n                        toolbarItem = element.data(type);\n                    }\n\n                    if (isResizable) {\n                        overflowItem = toolbarItem.twin();\n                    }\n                } else if (isResizable) { //find overflow item\n                    element = this.popup.element.find(candidate);\n                    type = element.length ? element.data(\"type\") : NOTHING;\n                    overflowItem = element.data(type);\n\n                    if (overflowItem && overflowItem.main) {\n                        element = element.parent(DOT + SPLIT_BUTTON);\n                        type = \"splitButton\";\n                        overflowItem = element.data(type);\n                    }\n                }\n\n                return {\n                    type: type,\n                    toolbar: toolbarItem,\n                    overflow: overflowItem\n                };\n            },\n\n            remove: function(candidate) {\n                var item = this._getItem(candidate);\n\n                if (item.toolbar) { item.toolbar.remove(); }\n                if (item.overflow) { item.overflow.remove(); }\n\n                this.resize(true);\n            },\n\n            hide: function(candidate) {\n                var item = this._getItem(candidate);\n                var buttonGroupInstance;\n\n                if (item.toolbar) {\n                    if (item.toolbar.options.type === BUTTON && item.toolbar.options.isChild) {\n                        buttonGroupInstance = item.toolbar.getParentGroup();\n\n                        item.toolbar.hide();\n\n                        if (buttonGroupInstance) {\n                            buttonGroupInstance.refresh();\n                        }\n                    } else if (!item.toolbar.options.hidden) {\n                        item.toolbar.hide();\n                    }\n                }\n\n                if (item.overflow) {\n                    if (item.overflow.options.type === BUTTON && item.overflow.options.isChild) {\n                        buttonGroupInstance = item.overflow.getParentGroup();\n\n                        item.overflow.hide();\n\n                        if(buttonGroupInstance) {\n                            buttonGroupInstance.refresh();\n                        }\n                    } else if(!item.overflow.options.hidden) {\n                        item.overflow.hide();\n                    }\n                }\n\n                this.resize(true);\n            },\n\n            show: function(candidate) {\n                var item = this._getItem(candidate);\n                var buttonGroupInstance;\n\n                if (item.toolbar) {\n                    if (item.toolbar.options.type === BUTTON && item.toolbar.options.isChild) {\n                        buttonGroupInstance = item.toolbar.getParentGroup();\n                        item.toolbar.show();\n\n                        if (buttonGroupInstance) {\n                            buttonGroupInstance.refresh();\n                        }\n                    } else if(item.toolbar.options.hidden) {\n                        item.toolbar.show();\n                    }\n                }\n\n                if (item.overflow) {\n                    if (item.overflow.options.type === BUTTON && item.overflow.options.isChild) {\n                        buttonGroupInstance = item.overflow.getParentGroup();\n\n                        item.toolbar.show();\n\n                        if (buttonGroupInstance) {\n                            buttonGroupInstance.refresh();\n                        }\n                    } else if(item.overflow.options.hidden) {\n                        item.overflow.show();\n                    }\n                }\n\n                this.resize(true);\n            },\n\n            enable: function(element, enable) {\n                var item = this._getItem(element);\n\n                if (typeof enable == \"undefined\") {\n                    enable = true;\n                }\n\n                if (item.toolbar) { item.toolbar.enable(enable); }\n                if (item.overflow) { item.overflow.enable(enable); }\n            },\n\n            getSelectedFromGroup: function(groupName) {\n                return this.element.find(DOT + TOGGLE_BUTTON + \"[data-group='\" + groupName + \"']\").filter(DOT + STATE_ACTIVE);\n            },\n\n            toggle: function(button, checked) {\n                var element = $(button),\n                    item = element.data(BUTTON);\n\n                if (item.options.togglable) {\n                    if (checked === undefined) {\n                        checked = true;\n                    }\n                    item.toggle(checked, true);\n                }\n            },\n\n            _renderOverflow: function() {\n                var that = this,\n                    overflowContainer = components.overflowContainer,\n                    isRtl = that._isRtl,\n                    horizontalDirection = isRtl ? \"left\" : \"right\";\n\n                that.overflowAnchor = $(components.overflowAnchor).addClass(KBUTTON);\n\n                that.element.append(that.overflowAnchor);\n\n                if (that.isMobile) {\n                    that.overflowAnchor.append('<span class=\"km-icon km-more\"></span>');\n                    overflowContainer = actionSheetWrap(overflowContainer);\n                } else {\n                    that.overflowAnchor.append('<span class=\"k-icon k-i-more-vertical\"></span>');\n                }\n\n                that.popup = new kendo.ui.Popup(overflowContainer, {\n                    origin: \"bottom \" + horizontalDirection,\n                    position: \"top \" + horizontalDirection,\n                    anchor: that.overflowAnchor,\n                    isRtl: isRtl,\n                    animation: that.animation,\n                    appendTo: that.isMobile ? $(that.isMobile).children(\".km-pane\") : null,\n                    copyAnchorStyles: false,\n                    open: function (e) {\n                        var wrapper = kendo.wrap(that.popup.element)\n                            .addClass(OVERFLOW_WRAPPER);\n\n                        if (!that.isMobile) {\n                            wrapper.css(\"margin-left\", (isRtl ? -1 : 1) * ((outerWidth(wrapper) - wrapper.width()) / 2 + 1));\n                        } else {\n                            that.popup.container.css(\"max-height\", (parseFloat($(\".km-content:visible\").innerHeight()) - 15) + \"px\");\n                        }\n\n                        if (that.trigger(OVERFLOW_OPEN)) {\n                            e.preventDefault();\n                        }\n                    },\n                    activate: function() {\n                        this.element.find(\":kendoFocusable\").first().trigger(FOCUS);\n                    },\n                    close: function (e) {\n                        if (that.trigger(OVERFLOW_CLOSE)) {\n                            e.preventDefault();\n                        }\n\n                        this.element.trigger(FOCUS);\n                    }\n                });\n\n                that.popup.element.on(KEYDOWN + ns, DOT + KBUTTON, function(e) {\n                    var target = $(e.target),\n                        li = target.parent(),\n                        isComplexTool = li.is(DOT + BUTTON_GROUP) || li.is(DOT + SPLIT_BUTTON),\n                        element;\n\n                    e.preventDefault();\n\n                    if (e.keyCode === keys.ESC || e.keyCode === keys.TAB || (e.altKey && e.keyCode === keys.UP)) {\n\n                        that._toggleOverflow();\n                        that.overflowAnchor.trigger(FOCUS);\n                    } else if (e.keyCode === keys.DOWN) {\n                        element = !isComplexTool || (isComplexTool && target.is(\":last-child\")) ? li : target;\n                        findFocusableSibling(element, NEXT).trigger(FOCUS);\n                    } else if (e.keyCode === keys.UP) {\n                        element = !isComplexTool || (isComplexTool && target.is(\":first-child\")) ? li : target;\n                        findFocusableSibling(element, PREV).trigger(FOCUS);\n                    } else if (e.keyCode === keys.SPACEBAR || e.keyCode === keys.ENTER) {\n                        that.userEvents.trigger(TAP, { target: $(e.target) });\n                        that.overflowAnchor.trigger(FOCUS);\n                    } else if (e.keyCode === keys.HOME) {\n                        li.parent().find(\":kendoFocusable\").first().trigger(FOCUS);\n                    } else if (e.keyCode === keys.END) {\n                        li.parent().find(\":kendoFocusable\").last().trigger(FOCUS);\n                    }\n                });\n\n                if (that.isMobile) {\n                    that.popup.container = that.popup.element.find(DOT + OVERFLOW_CONTAINER);\n                } else {\n                    that.popup.container = that.popup.element;\n                }\n\n                that.popup.container.attr(KENDO_UID_ATTR, this.uid);\n            },\n\n            _toggleOverflowAnchor: function() {\n                var hasVisibleChildren = false;\n                var paddingEnd = this._isRtl ? \"padding-left\" : \"padding-right\";\n\n                if (this.options.mobile) {\n                    hasVisibleChildren = this.popup.element.find(DOT + OVERFLOW_CONTAINER).children(\":not(.\" + OVERFLOW_HIDDEN + \", .\" + POPUP + \")\").length > 0;\n                } else {\n                    hasVisibleChildren = this.popup.element.children(\":not(.\" + OVERFLOW_HIDDEN + \", .\" + POPUP + \")\").length > 0;\n                }\n\n                if (hasVisibleChildren) {\n                    this.overflowAnchor.css({\n                        visibility: \"visible\",\n                        width: NOTHING\n                    });\n                    this.wrapper.css(paddingEnd, this.overflowAnchor.outerWidth(true));\n                } else {\n                    this.overflowAnchor.css({\n                        visibility: \"hidden\",\n                        width: \"1px\"\n                    });\n                    this.wrapper.css(paddingEnd, NOTHING);\n                }\n            },\n\n            _buttonClick: function(e) {\n                var that = this, popup,\n                    target, item, splitContainer,\n                    isSplitButtonArrow = e.target.closest(DOT + SPLIT_BUTTON_ARROW).length,\n                    handler, eventData, urlTarget;\n\n                e.preventDefault();\n\n                if (isSplitButtonArrow) {\n                    that._toggle(e);\n                    return;\n                }\n\n                target = $(e.target).closest(DOT + KBUTTON + COMMA + EMPTY + DOT + MENU_LINK, that.element);\n\n                if (target.hasClass(OVERFLOW_ANCHOR)) {\n                    return;\n                }\n\n                item = target.data(BUTTON);\n\n                if (!item && that.popup) {\n                    target = $(e.target).closest(DOT + OVERFLOW_BUTTON, that.popup.container);\n                    item = target.parent(\"li\").data(BUTTON);\n                }\n\n                if (!item || !item.options.enable) {\n                    return;\n                }\n\n                if (item.options.togglable) {\n                    handler = isFunction(item.toggleHandler) ? item.toggleHandler : null;\n\n                    item.toggle(!item.options.selected, true);\n                    eventData = { target: target, group: item.options.group, checked: item.options.selected, id: item.options.id, item: item };\n\n                    if (handler) { handler.call(that, eventData); }\n                    that.trigger(TOGGLE, eventData);\n                } else {\n                    handler = isFunction(item.clickHandler) ? item.clickHandler : null;\n                    eventData = { sender: that, target: target, id: item.options.id, item: item };\n\n                    if (handler) { handler.call(that, eventData); }\n                    that.trigger(CLICK, eventData);\n                }\n\n                if (item.options.url) {\n                    if (item.options.attributes && item.options.attributes.target) {\n                        urlTarget = item.options.attributes.target;\n                    }\n                    window.open(item.options.url, urlTarget || \"_self\");\n                }\n\n                if (target.hasClass(OVERFLOW_BUTTON)) {\n                    that.popup.close();\n                }\n\n                splitContainer = target.closest(\".k-split-container\");\n                if (splitContainer[0]) {\n                    popup = splitContainer.data(\"kendoPopup\");\n                    (popup ? popup : splitContainer.parents(\".km-popup-wrapper\").data(\"kendoPopup\")).close();\n                }\n            },\n\n            _navigatable: function() {\n                var that = this;\n\n                that.element\n                    .attr(TABINDEX, 0)\n                    .on(FOCUSIN + ns, function(ev) {\n                        var target = $(ev.target);\n                        var element = $(this).find(\":kendoFocusable\").first();\n\n                        if (!target.is(DOT + TOOLBAR) || element.length === 0) {\n                            return;\n                        }\n\n                        if (element.is(DOT + OVERFLOW_ANCHOR)) {\n                            element = findFocusableSibling(element, NEXT);\n                        }\n\n                        if(element.length) {\n                            element[0].focus();\n                        }\n                    })\n                    .on(KEYDOWN + ns, that._keydown.bind(that));\n            },\n\n            _keydown: function(e) {\n                var target = $(e.target),\n                    keyCode = e.keyCode,\n                    items = this.element.children(\":not(.k-separator):visible\"),\n                    direction = this._isRtl ? -1 : 1;\n\n                if (keyCode === keys.TAB) {\n                    var element = target.parentsUntil(this.element).last(),\n                        lastHasFocus = false,\n                        firstHasFocus = false,\n                        isOnlyOverflowAnchor = false;\n\n                    if(!items.not(DOT + OVERFLOW_ANCHOR).length){\n                        isOnlyOverflowAnchor = true;\n                    }\n\n                    if (!element.length) {\n                        element = target;\n                    }\n\n                    if (element.is(DOT + OVERFLOW_ANCHOR) && !isOnlyOverflowAnchor) {\n                        var lastItemNotOverflowAnchor = items.last();\n\n                        if (e.shiftKey) {\n                            e.preventDefault();\n                        }\n\n                        if (lastItemNotOverflowAnchor.is(\":kendoFocusable\")) {\n                            items.last().trigger(FOCUS);\n                        } else {\n                            items.last().find(\":kendoFocusable\").last().trigger(FOCUS);\n                        }\n                    }\n\n                    if (!e.shiftKey && items.index(element) === items.length - 1) {\n                        if (element.is(DOT + BUTTON_GROUP)) {\n                            lastHasFocus = target.is(\":last-child\");\n                        } else {\n                            lastHasFocus = true;\n                        }\n                    }\n\n                    var isFirstTool = items.index(element) === items.not(\".k-overflow-anchor\").first().index();\n                    if (e.shiftKey && isFirstTool) {\n                        if (element.is(DOT + BUTTON_GROUP)) {\n                            firstHasFocus = target.is(\":first-child\");\n                        } else {\n                            firstHasFocus = true;\n                        }\n                    }\n\n                    if (lastHasFocus && this.overflowAnchor && this.overflowAnchor.css(\"visibility\") !== \"hidden\" && !isOnlyOverflowAnchor) {\n                        e.preventDefault();\n                        this.overflowAnchor.trigger(FOCUS);\n                    }\n\n                    if (firstHasFocus || (isOnlyOverflowAnchor && e.shiftKey)) {\n                        e.preventDefault();\n                        var prevFocusable = this._getPrevFocusable(this.wrapper);\n                        if (prevFocusable) {\n                            prevFocusable.trigger(FOCUS);\n                        }\n                    }\n                    this._preventNextFocus = false;\n                }\n\n                if (e.altKey && keyCode === keys.DOWN) {\n                    var splitButton = $(document.activeElement).data(\"splitButton\");\n                    var isOverflowAnchor = $(document.activeElement).is(DOT + OVERFLOW_ANCHOR);\n\n                    if (splitButton) {\n                        splitButton.toggle();\n                    } else if (isOverflowAnchor) {\n                        this._toggleOverflow();\n                    }\n\n                    return;\n                }\n\n                if ((keyCode === keys.SPACEBAR || keyCode === keys.ENTER) && !target.is(\"input, checkbox\")) {\n\n                    if(keyCode === keys.SPACEBAR){\n                        e.preventDefault(); //prevent spacebar to scroll the page down\n                    }\n\n                    if (target.is(DOT + SPLIT_BUTTON)) {\n                        target = target.children().first();\n                        this.userEvents.trigger(TAP, { target: target });\n                    } else if (keyCode === keys.SPACEBAR) {\n                        this.userEvents.trigger(TAP, { target: target });\n                    }\n\n                    return;\n                }\n\n                if (keyCode === keys.HOME) {\n                    if (target.is(\".k-dropdownlist\") || target.is(\"input\")) {\n                        return;\n                    }\n\n                    if (this.overflowAnchor) {\n                        items.eq(1).trigger(FOCUS);\n                    } else {\n                        items.first().trigger(FOCUS);\n                    }\n                    e.preventDefault();\n                } else if (keyCode === keys.END) {\n                    if (target.is(\".k-dropdownlist\") || target.is(\"input\")) {\n                        return;\n                    }\n                    if (this.overflowAnchor && $(this.overflowAnchor).css(\"visibility\") != \"hidden\") {\n                        this.overflowAnchor.trigger(FOCUS);\n                    } else {\n                        items.last().trigger(FOCUS);\n                    }\n                    e.preventDefault();\n                } else if (keyCode === keys.RIGHT && !this._preventNextFocus && !target.is(\"input, select, .k-dropdownlist, .k-colorpicker\") && this._getNextElement(e.target, 1 * direction)) {\n                    this._getNextElement(e.target, 1 * direction).focus();\n                    e.preventDefault();\n                } else if (keyCode === keys.LEFT && !this._preventNextFocus && !target.is(\"input, select, .k-dropdownlist, .k-colorpicker\") && this._getNextElement(e.target, -1 * direction)) {\n                    this._getNextElement(e.target, -1 * direction).focus();\n                    e.preventDefault();\n                }\n            },\n\n            _getNextElement: function (item, direction) {\n                var items = this.element.children(\":not(.k-separator, .k-spacer):visible\");\n                var itemIndex = items.index(item) === -1 ? items.index(item.parentElement) : items.index(item);\n                var startIndex = this.overflowAnchor ? 1 : 0;\n                var directionNumber = direction;\n                var searchIndex = direction === 1 ? items.length - 1 : startIndex;\n                var index = direction === 1 ? startIndex : items.length - 1;\n                var focusableItem = items[itemIndex + direction];\n                this._preventNextFocus = false;\n\n                if ($(item).closest(DOT + BUTTON_GROUP).not(DOT + SPLIT_BUTTON).length && !$(item).is(direction === 1 ? \":last-child\" : \":first-child\")) {\n                    return $(item)\n                        .closest(DOT + BUTTON_GROUP)\n                        .children()[$(item)\n                        .closest(DOT + BUTTON_GROUP)\n                        .children()\n                        .index(item) + direction];\n                }\n\n                if (this.overflowAnchor && item === this.overflowAnchor[0] && direction === -1) {\n                    focusableItem = items[items.length - 1];\n                }\n\n                if (itemIndex === searchIndex) {\n                    focusableItem = !this.overflowAnchor ||\n                        (this.overflowAnchor &&\n                        $(this.overflowAnchor).css(\"visibility\") === \"hidden\") ? items[index] : this.overflowAnchor;\n                }\n\n                while (!$(focusableItem).is(\":kendoFocusable\")) {\n                    if (direction === -1 && $(focusableItem).closest(DOT + BUTTON_GROUP).length) {\n                        focusableItem = $(focusableItem).children(\":not(label, div)\").last();\n                    } else {\n                        focusableItem = $(focusableItem).children(\":not(label, div)\").first();\n                    }\n                    if (!focusableItem.length) {\n                        directionNumber = directionNumber + direction;\n                        focusableItem = items[itemIndex + directionNumber];\n                        if (!focusableItem) {\n                            return this.overflowAnchor;\n                        }\n                    }\n\n                    if ($(focusableItem).hasClass(\"k-combobox\")) {\n                        focusableItem = $(focusableItem).find(\"input\");\n                    }\n                    this._preventNextFocus = $(focusableItem).closest(DOT + BUTTON_GROUP).length ? false : true;\n                }\n\n                return focusableItem;\n            },\n\n            _getPrevFocusable: function(element) {\n                if (element.is(\"html\")) {\n                    return element;\n                }\n\n                var elementToFocus, prevElement,\n                    prevElements = element.prevAll();\n                prevElements.each(function(){\n                    prevElement = $(this);\n                    if (prevElement.is(\":kendoFocusable\")) {\n                        elementToFocus = prevElement;\n                        return false;\n                    } else if (prevElement.find(\":kendoFocusable\").length > 0) {\n                        elementToFocus = prevElement.find(\":kendoFocusable\").last();\n                        return false;\n                    }\n                });\n                if (elementToFocus) {\n                    return elementToFocus;\n                } else {\n                    return this._getPrevFocusable(element.parent());\n                }\n            },\n\n            _toggle: function(e) {\n                var splitButton = $(e.target).closest(DOT + SPLIT_BUTTON).data(\"splitButton\");\n\n                e.preventDefault();\n\n                if (!splitButton.options.enable) {\n                    return;\n                }\n\n                splitButton.toggle();\n            },\n\n            _toggleOverflow: function() {\n                this.popup.toggle();\n            },\n\n            _resize: function(e) {\n                var containerWidth = e.width;\n\n                if (!this.options.resizable) {\n                    return;\n                }\n\n                this.popup.close();\n\n                this._shrink(containerWidth);\n                this._stretch(containerWidth);\n\n                this._markVisibles();\n\n                this._toggleOverflowAnchor();\n            },\n\n            _childrenWidth: function() {\n                var childrenWidth = 0;\n\n                this.element.children(\":visible:not(.\" + STATE_HIDDEN + COMMA + EMPTY + DOT + SPACER_CLASS + \")\").each(function() {\n                    childrenWidth += outerWidth($(this), true);\n                });\n\n                return Math.ceil(childrenWidth);\n            },\n\n            _shrink: function(containerWidth) {\n                var commandElement,\n                    visibleCommands;\n\n                if (containerWidth < this._childrenWidth()) {\n                    visibleCommands = this.element.children(\":visible:not([data-overflow='never'], .\" + OVERFLOW_ANCHOR + \")\");\n\n                    for (var i = visibleCommands.length - 1; i >= 0; i--) {\n                        commandElement = visibleCommands.eq(i);\n\n                        if (containerWidth > this._childrenWidth()) {\n                            break;\n                        } else {\n                            this._hideItem(commandElement);\n                        }\n                    }\n                }\n            },\n\n            _stretch: function(containerWidth) {\n                var commandElement,\n                    hiddenCommands;\n\n                if (containerWidth > this._childrenWidth()) {\n                    hiddenCommands = this.element.children(\":hidden:not('.\" + STATE_HIDDEN + \"')\");\n\n                    for (var i = 0; i < hiddenCommands.length ; i++) {\n                        commandElement = hiddenCommands.eq(i);\n                        if (containerWidth < this._childrenWidth() || !this._showItem(commandElement, containerWidth)) {\n                            break;\n                        }\n                    }\n                }\n            },\n\n            _hideItem: function(item) {\n                item.addClass(HIDDEN);\n\n                if (this.popup) {\n                    this.popup.container\n                        .find(\">li[data-uid='\" + item.data(\"uid\") + \"']\")\n                        .removeClass(OVERFLOW_HIDDEN);\n                }\n            },\n\n            _showItem: function(item, containerWidth) {\n                // From jquery.outerWidth docs:\n                //  > jQuery will attempt to temporarily show and then re-hide an element\n                //  > in order to measure its dimensions, but this is unreliable\n                // Thus we show and hide the item\n                item.removeClass(HIDDEN);\n                var itemOuterWidth = outerWidth(item, true);\n                item.addClass(HIDDEN);\n\n                if (item.length && containerWidth > this._childrenWidth() + itemOuterWidth) {\n\n                    item.removeClass(HIDDEN);\n\n                    if (this.popup) {\n                        this.popup.container\n                            .find(\">li[data-uid='\" + item.data(\"uid\") + \"']\")\n                            .addClass(OVERFLOW_HIDDEN);\n                    }\n\n                    return true;\n                }\n\n                return false;\n            },\n\n            _markVisibles: function() {\n                var overflowItems = this.popup.container.children(),\n                    toolbarItems = this.element.children(\":not(.k-overflow-anchor)\"),\n                    visibleOverflowItems = overflowItems.filter(\":not(.k-overflow-hidden)\"),\n                    visibleToolbarItems = toolbarItems.filter(\":visible\");\n\n                overflowItems.add(toolbarItems).removeClass(FIRST_TOOLBAR_VISIBLE + EMPTY + LAST_TOOLBAR_VISIBLE);\n                visibleOverflowItems.first().add(visibleToolbarItems.first()).addClass(FIRST_TOOLBAR_VISIBLE);\n                visibleOverflowItems.last().add(visibleToolbarItems.last()).addClass(LAST_TOOLBAR_VISIBLE);\n            }\n\n        });\n\n    kendo.ui.plugin(ToolBar);\n})(window.kendo.jQuery);\n\nreturn window.kendo;\n\n}, typeof define == 'function' && define.amd ? define : function(a1, a2, a3){ (a3 || a2)(); });\n\n"],"names":["define","__meta__","id","name","category","description","depends","$","window","kendo","jQuery","undefined","Class","Widget","ui","isFunction","keys","outerWidth","_outerWidth","ns","TOOLBAR","KBUTTON","BUTTON_DEFAULTS","OVERFLOW_BUTTON","TOGGLE_BUTTON","BUTTON_GROUP","SPLIT_BUTTON","SPLIT_BUTTON_ARROW","LIST_CONTAINER","ICON_BUTTON","KSEPARATOR","SPACER_CLASS","POPUP","RESIZABLE_TOOLBAR","STATE_ACTIVE","STATE_DISABLED","STATE_HIDDEN","HIDDEN","GROUP_START","GROUP_END","MENU_LINK","OVERFLOW_GROUP","OVERFLOW_HIDDEN","OVERFLOW_ANCHOR","OVERFLOW_CONTAINER","OVERFLOW_WRAPPER","FIRST_TOOLBAR_VISIBLE","LAST_TOOLBAR_VISIBLE","BUTTON_ROUNDED_MD","MENU_GROUP","ARIA_DISABLED","ARIA_PRESSED","CLICK","TOGGLE","OPEN","CLOSE","FOCUS","FOCUSIN","KEYDOWN","TAP","SPACER","BOTH","PRIMARY","HREF","ROLE","BUTTON","SEPARATOR","OVERFLOW","NEXT","PREV","TABINDEX","TEMPLATE","OVERFLOW_OPEN","OVERFLOW_CLOSE","OVERFLOW_NEVER","OVERFLOW_AUTO","OVERFLOW_ALWAYS","OPTION_LIST_SUFFIX","KENDO_UID_ATTR","attr","POPUP_ITEM_TEMPLATE","MENU_LINK_SPAN","MENU_LINK_A","EMPTY","NOTHING","DOT","COMMA","ID","components","toolbar","overflowAnchor","overflowContainer","Item","registerComponent","overflow","extend","addOverflowAttr","this","element","options","addUidAttr","uid","addIdAttr","addOverflowIdAttr","attributes","classes","class","addClass","show","removeClass","hidden","hide","overflowHidden","remove","enable","isEnabled","toggleClass","twin","splitContainerId","find","data","type","resizable","popup","Button","init","useButtonTag","primary","themeColor","togglable","toggle","selected","url","mobile","group","addToGroup","click","clickHandler","toggleHandler","showIcon","showText","state","propagate","select","getParentGroup","isChild","closest","ToolBarButton","fn","call","align","text","html","icon","spriteCssClass","imageUrl","renderButton","button","OverflowButton","_wrap","wrap","parent","ButtonGroup","createButtons","buttonConstructor","items","buttons","item","i","length","guid","appendTo","refresh","children","filter","first","last","ToolBarButtonGroup","buttonGroup","OverflowButtonGroup","ToolBarMenuButton","img","span","template","href","prependTo","ToolBarSplitButton","mainButton","arrowButton","popupElement","removeAttr","createMenuButtons","createPopup","_navigatable","main","splitButton","kendoPopup","that","on","e","li","target","preventDefault","keyCode","ESC","TAB","altKey","UP","focus","DOWN","findFocusableSibling","trigger","SPACEBAR","ENTER","userEvents","HOME","END","menuButtons","rootUid","actionSheetWrap","anchor","isRtl","_isRtl","copyAnchorStyles","animation","open","isDefaultPrevented","adjustPopupWidth","sender","activate","close","preventClick","computedWidth","width","css","fontFamily","min-width","off","destroy","visible","OverflowSplitButton","ToolBarSeparator","separator","OverflowSeparator","ToolBarSpacer","TemplateItem","OverflowTemplateItem","toggleActive","is","hasClass","dir","getSibling","next","prev","getter","candidate","Group","add","index","inArray","splice","tmp","ToolBar","wrapper","support","_groups","isMobile","effects","_renderOverflow","overflowUserEvents","UserEvents","threshold","allowSelection","tap","_toggleOverflow","bind","_resizeHandler","onResize","resize","_shrink","innerWidth","document","documentElement","_buttonClick","press","release","_toggleOverflowAnchor","notify","events","groupName","each","idx","unbindResize","component","tool","itemClasses","overflowTemplate","overflowTool","container","angular","elements","get","_getItem","toolbarItem","overflowItem","isResizable","buttonGroupInstance","getSelectedFromGroup","checked","horizontalDirection","append","Popup","origin","position","parseFloat","innerHeight","isComplexTool","hasVisibleChildren","paddingEnd","visibility","splitContainer","isSplitButtonArrow","handler","eventData","urlTarget","_toggle","parents","ev","_keydown","direction","parentsUntil","lastHasFocus","firstHasFocus","isOnlyOverflowAnchor","not","lastItemNotOverflowAnchor","shiftKey","isFirstTool","prevFocusable","_getPrevFocusable","_preventNextFocus","activeElement","isOverflowAnchor","eq","RIGHT","_getNextElement","LEFT","itemIndex","parentElement","startIndex","directionNumber","searchIndex","focusableItem","elementToFocus","prevElement","prevElements","prevAll","_resize","containerWidth","_stretch","_markVisibles","_childrenWidth","childrenWidth","Math","ceil","commandElement","visibleCommands","_hideItem","hiddenCommands","_showItem","itemOuterWidth","overflowItems","toolbarItems","visibleOverflowItems","visibleToolbarItems","plugin","amd","a1","a2","a3"],"mappings":"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"}